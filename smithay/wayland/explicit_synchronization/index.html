<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `explicit_synchronization` mod in crate `smithay`."><meta name="keywords" content="rust, rustlang, rust-lang, explicit_synchronization"><title>smithay::wayland::explicit_synchronization - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css"><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script src="../../../storage.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="shortcut icon" href="../../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../../smithay/index.html'><div class='logo-container'><img src='../../../rust-logo.png' alt='logo'></div></a><p class='location'>Module explicit_synchronization</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></div><p class='location'><a href='../../index.html'>smithay</a>::<wbr><a href='../index.html'>wayland</a></p><script>window.sidebarCurrent = {name: 'explicit_synchronization', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../../src/smithay/wayland/explicit_synchronization/mod.rs.html#1-315' title='goto source code'>[src]</a></span><span class='in-band'>Module <a href='../../index.html'>smithay</a>::<wbr><a href='../index.html'>wayland</a>::<wbr><a class="mod" href=''>explicit_synchronization</a></span></h1><div class='docblock'><p>Explicit buffer synchronization per wayland surface</p>
<p>This interface allow clients to switch from a per-buffer signaling of buffer release (via the
<code>wl_buffer.release</code> event) to a per-surface signaling using <code>dma_fence</code>s. This is notably used for
efficient synchronization of OpenGL/Vulkan clients.</p>
<p>At surface commit time, in addition to a buffer the client can have attached two more properties:</p>
<ul>
<li>an acquire <code>dma_fence</code> file descriptor, that the compositor is required to wait on before it will
try to access the contents of the associated buffer</li>
<li>an <code>ExplicitBufferRelease</code> object, that the compositor is expect to use to signal the client when it has
finished using the buffer for this surface (if the same buffer is attached to multiple surfaces, the
release only applies for the surface associated with this release object, not the whole buffer).</li>
</ul>
<p>The use of these <code>dma_fence</code>s in conjunction with the graphics stack allows for efficient synchronization
between the clients and the compositor.</p>
<h2 id="usage" class="section-header"><a href="#usage">Usage</a></h2>
<p>First, you need to initialize the global:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">smithay</span>::<span class="ident">wayland</span>::<span class="ident">explicit_synchronization</span>::<span class="kw-2">*</span>;
<span class="ident">init_explicit_synchronization_global</span>(
    <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">display</span>,
    <span class="ident">compositor_token</span>,
    <span class="prelude-val">None</span> <span class="comment">/* You can insert a logger here */</span>
);</pre></div>
<p>Then when handling a surface commit, you can retrieve the synchronization information for the surface
data:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="ident">compositor_token</span>.<span class="ident">with_surface_data</span>(<span class="kw-2">&amp;</span><span class="ident">surface</span>, <span class="op">|</span><span class="ident">surface_attributes</span><span class="op">|</span> {
    <span class="comment">// While you retrieve the surface data from the commit ...</span>
    <span class="comment">// Check the explicit synchronization data:</span>
    <span class="kw">match</span> <span class="ident">get_explicit_synchronization_state</span>(<span class="ident">surface_attributes</span>) {
        <span class="prelude-val">Ok</span>(<span class="ident">sync_state</span>) <span class="op">=&gt;</span> {
            <span class="comment">/* This surface is explicitly synchronized, you need to handle
               the contents of sync_state
            */</span>
        },
        <span class="prelude-val">Err</span>(()) <span class="op">=&gt;</span> {
            <span class="comment">/* This surface is not explicitly synchronized, nothing more to do
            */</span>
        }
    }
});</pre></div>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.ExplicitBufferRelease.html" title='smithay::wayland::explicit_synchronization::ExplicitBufferRelease struct'>ExplicitBufferRelease</a></td><td class='docblock-short'><p>An object to signal end of use of a buffer</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.ExplicitSyncState.html" title='smithay::wayland::explicit_synchronization::ExplicitSyncState struct'>ExplicitSyncState</a></td><td class='docblock-short'><p>An explicit synchronization state</p>
</td></tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table><tr class='module-item'><td><a class="enum" href="enum.ExplicitSyncError.html" title='smithay::wayland::explicit_synchronization::ExplicitSyncError enum'>ExplicitSyncError</a></td><td class='docblock-short'><p>Possible errors you can send to an ill-behaving clients</p>
</td></tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table><tr class='module-item'><td><a class="fn" href="fn.get_explicit_synchronization_state.html" title='smithay::wayland::explicit_synchronization::get_explicit_synchronization_state fn'>get_explicit_synchronization_state</a></td><td class='docblock-short'><p>Retrieve the explicit synchronization state commited by the client</p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.init_explicit_synchronization_global.html" title='smithay::wayland::explicit_synchronization::init_explicit_synchronization_global fn'>init_explicit_synchronization_global</a></td><td class='docblock-short'><p>Initialize the explicit synchronization global</p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.send_explicit_synchronization_error.html" title='smithay::wayland::explicit_synchronization::send_explicit_synchronization_error fn'>send_explicit_synchronization_error</a></td><td class='docblock-short'><p>Send a synchronization error to a client</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../../../";window.currentCrate = "smithay";</script><script src="../../../aliases.js"></script><script src="../../../main.js"></script><script defer src="../../../search-index.js"></script></body></html>